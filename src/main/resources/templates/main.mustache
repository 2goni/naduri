<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--    font awsome-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <title>Hello, world!</title>
    <script src="http://code.jquery.com/jquery-1.11.0.js"></script>
<!--    -->
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<!--    -->
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=adf6j9fk15&submodules=geocoder"></script>

    <script>
        $(document).ready(function(){
            $("#sidebtn").click(function(){
                $("#sidebar").css({left:0});
            });
            $("#exit3").click(function(){
                $("#sidebar").css({left:-700});
            });
        });
    </script>
    <style>
        ul,ol,li{margin:0;padding:0;}
    </style>
</head>
<body>
<nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div class="container-fluid">
        <button class="navbar-toggler ml-auto custom-toggler" id="sidebtn" style="background-color: #e3f2fd;" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a href="testcode.html">
            <div class="text-center">
                <img src="balbal.svg" class="rounded" width="30" height="30" alt="logo">
            </div>
        </a>
        <p class="fst-italic">Naduri </p>
    </div>
    <div id="map">

    </div>
</nav>
<!--<div class="collapse" id="navbarToggleExternalContent" >-->
<!--    <div class="bg-white p-4">-->
<!--        <h5 class="text-dark h4">Collapsed content</h5>-->
<!--        <span class="text-muted">Toggleable via the navbar brand.</span>-->
<!--    </div>-->
<!--</div>-->
<div id="sidebar" style="position:absolute; background:#e3f2fd; width:700px; height:100%; top:0; left:-700px;z-index: 10;transition: 1s;"   >
    <a href="/signin">
        <div id="login">
            <i class="fas fa-user-alt"></i>
            <span>로그인을 해주세요</span>
        </div>
    </a>
    <hr>
    <i id="exit3" class="fas fa-times-circle" style="position:absolute; right:0; top:0; font-size:30px; margin-right:10px; margin-top:10px; " ></i>
    <ul style="list-style:none; margin:0;">
        <li>나의 코스 목록</li>
        <li>나의 코스 목록</li>
        <li>나의 코스 목록</li>
        <li>나의 코스 목록</li>
        <li>나의 코스 목록</li>
    </ul>
</div>
<!--nav-->

<div class="location">
    <div id="address1"></div>
</div>
<div class="card w-100">
    <div class="card-body">
        <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <div class="card text-center">
                        <div class="card-header">
                            [해우제]경기도 수원시 장안구 장안로 458(이목동)
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-7">
                                    <img src="temp1.jpeg" width="170" height="170" alt="사진">
                                </div>
                                <div class="col-5">
                                    <h5 class="card-title">태그(ex_#수원#권선동)</h5>
                                    <a href="review.html" style="color:black" class="btn btn-primary">별점+코멘트
                                        <img src="star.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">
                                        <img src="star_half.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">&nbsp;2.5
                                    </a>
                                    <p class="card-text">유저이미지+아이디</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-muted">
                            게시일(ex_2021.01.02)
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="card text-center">
                        <div class="card-header">
                            [해??]경기도 수원시 장안구 장안로 458(이목동)
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-7">
                                    <img src="temp2.jpeg" width="170" height="170" alt="사진">
                                </div>
                                <div class="col-5">
                                    <h5 class="card-title">태그(ex_#수우우우우)</h5>
                                    <a href="review.html" style="color:black" class="btn btn-primary">별점+코멘트
                                        <img src="star.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">
                                        <img src="star_half.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">&nbsp;4.5
                                    </a>
                                    <p class="card-text">유저이미지+아이디</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-muted">
                            게시일(ex_2021.01.03)
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="card text-center">
                        <div class="card-header">
                            [???]경기도 수원시 장안구
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-7">
                                    <img src="temp1.jpeg" width="170" height="170" alt="사진">
                                </div>
                                <div class="col-5">
                                    <h5 class="card-title">태그(ex_#수원#권선동)</h5>
                                    <a href="review.html" style="color:black" class="btn btn-primary">별점+코멘트
                                        <img src="star.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">
                                        <img src="star_half.png" class="rounded" width="15" height="15" alt="리뷰 목록으로">&nbsp;3.5
                                    </a>
                                    <p class="card-text">유저이미지+아이디</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-muted">
                            게시일(ex_2021.01.03)
                        </div>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
</div>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
-->
<script>
    navigator.geolocation
    {
        //위치 정보를 얻기
        navigator.geolocation.getCurrentPosition(function (pos) {
            var map = new naver.maps.Map("map", {
                center: new naver.maps.LatLng(pos.coords.latitude,pos.coords.longitude),
                zoom: 15,
                mapTypeControl: true
            });

            map.setCursor(map.center);
            searchCoordinateToAddress(map.center);


            function searchCoordinateToAddress(latlng) {
                naver.maps.Service.reverseGeocode({
                    coords: latlng,
                    orders: [
                        naver.maps.Service.OrderType.ADDR,
                        naver.maps.Service.OrderType.ROAD_ADDR
                    ].join(',')
                }, function(status, response) {
                    if (status === naver.maps.Service.Status.ERROR) {
                        if (!latlng) {
                            return alert('ReverseGeocode Error, Please check latlng');
                        }
                        if (latlng.toString) {
                            return alert('ReverseGeocode Error, latlng:' + latlng.toString());
                        }
                        if (latlng.x && latlng.y) {
                            return alert('ReverseGeocode Error, x:' + latlng.x + ', y:' + latlng.y);
                        }
                        return alert('ReverseGeocode Error, Please check latlng');
                    }

                    var address = response.v2.address,
                            htmlAddresses = [];

                    if (address.jibunAddress !== '') {
                        htmlAddresses.push(address.jibunAddress);
                    }

                    if (address.roadAddress !== '') {
                        htmlAddresses.push(address.roadAddress);
                    }

                    document.getElementById("address1").innerHTML = ([
                        '<div style="padding:10px;min-width:200px;line-height:150%;">',
                        htmlAddresses[0],
                        '</div>'
                    ].join('\n'));

                    var data2 = {
                        "지번" : address.jibunAddress,
                        "도로명주소" : address.roadAddress,
                        "위도" : pos.coords.latitude,
                        "경도" : pos.coords.longitude
                    };
                    // var list = [address.jibunAddress,address.roadAddress,pos.coords.latitude,pos.coords.longitude]
                    //  console.log(list);
                    // console.log(list.join(','));
                    $.ajax({
                        type:'POST',
                        url:'main',
                        data: {
                            a:address.jibunAddress,
                            b:address.roadAddress,
                            c:pos.coords.latitude,
                            d:pos.coords.longitude
                        },
                        success:function(){
                            console.log("success");
                        }
                    })

                });

            }
            function searchAddressToCoordinate(address) {
                naver.maps.Service.geocode({
                    query: address
                }, function(status, response) {
                    if (status === naver.maps.Service.Status.ERROR) {
                        if (!address) {
                            return alert('Geocode Error, Please check address');
                        }
                        return alert('Geocode Error, address:' + address);
                    }

                    if (response.v2.meta.totalCount === 0) {
                        return alert('No result.');
                    }

                    var htmlAddresses = [],
                            item = response.v2.addresses[0],
                            point = new naver.maps.Point(item.x, item.y);

                    if (item.roadAddress) {
                        htmlAddresses.push('[도로명 주소] ' + item.roadAddress);
                    }

                    if (item.jibunAddress) {
                        htmlAddresses.push('[지번 주소] ' + item.jibunAddress);
                    }

                    if (item.englishAddress) {
                        htmlAddresses.push('[영문명 주소] ' + item.englishAddress);
                    }
                    map.setCenter(point);
                });
            }

            function initGeocoder() {
                if (!map.isStyleMapReady) {
                    return;
                }


                map.addListener('click',function(e) {
                    searchCoordinateToAddress(e.coord);
                });

                $('#address').on('keydown', function(e) {
                    var keyCode = e.which;

                    if (keyCode === 13) { // Enter Key
                        searchAddressToCoordinate($('#address').val());
                    }
                });
            }

            $('#submit').on('click', function(e) {
                e.preventDefault();

                searchAddressToCoordinate($('#address').val());
            });


            naver.maps.onJSContentLoaded = initGeocoder;
            naver.maps.Event.once(map, 'init_stylemap', initGeocoder);

        });
    }

</script>
</body>
</html>